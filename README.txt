Visitor parser written by Brian Goetz
